# 提案：整合视口跟随与选中逻辑 (Consolidate Viewport & Selection)

## 摘要
本提案整合并规范了 AI 画布在生成内容后的视口跟随行为及交互逻辑。主要包括：新画板自动选中、智能视口自适应（缩放适应 vs 最小平移）、以及在极限缩放下的最小路径平移算法。

## 目标
建立一套稳定、流畅且符合用户直觉的画布交互规范，解决之前版本中视口跳跃大、新内容不可见或选中状态缺失的问题。

## 核心逻辑

### 1. 自动选中 (Auto-Selection)
- **行为**: 当新画板 (Frame) 生成并放置在画布上后，立即将其置为选中状态。
- **目的**: 方便用户立即查看属性或进行后续操作，减少点击步骤。

### 2. 视口自适应策略 (Adaptive Viewport Strategy)
系统根据新内容与当前视口的关系，采取分级处理策略：

#### A. 内容在视口内 (Inside)
- **判定**: 新画板完全位于当前安全视口（Safe Viewport）范围内（含 1px 容差）。
- **动作**: **保持静止**。视口不进行任何移动或缩放。
- **收益**: 提供最稳定的视觉体验，适合连续生成场景。

#### B. 内容在视口外 (Outside) - 尝试缩放适应 (Fit)
- **判定**: 联合包围盒（当前视口 + 新画板）的适配缩放比例 (`fitZoom`) **大于等于** 最小缩放比例 (`MIN_ZOOM = 0.01`)。
- **动作**: 执行 **Zoom to Fit**。调整视口位置和缩放比例，使联合区域居中显示。
- **收益**: 用户能看到全局上下文，且内容不会过小。

#### C. 内容在视口外 (Outside) - 降级为平移 (Pan)
- **判定**: 适配缩放比例 (`fitZoom`) **小于** 最小缩放比例。这意味着如果要展示所有内容，缩放比例会太小导致不可读。
- **动作**: 执行 **最小路径平移 (Minimal Path Pan)**。
  - 保持当前缩放比例（或 `MIN_ZOOM`）。
  - 仅移动视口必要的距离，使新画板刚刚好进入安全区域。
- **收益**: 保证新内容清晰可见，同时避免为了展示旧内容而牺牲可读性或产生剧烈的视觉跳跃。

## 归档说明
本提案整合并替代了以下临时提案：
- `auto-select-generated-board`
- `fix-viewport-pan-at-min-zoom`
- `optimize-viewport-stability`
- `minimal-path-pan-logic`
